(function(){"use strict";var e={36347:function(e,t,n){var o=n(49963),s=n(66252),i=n(3577);const a=e=>((0,s.dD)("data-v-26879810"),e=e(),(0,s.Cn)(),e),r={id:"app"},l={class:"cache-info"},c={class:"toolbar"},u=a((()=>(0,s._)("div",{style:{flex:"1"}},null,-1))),d={class:"list"};function h(e,t,o,a,h,p){const f=(0,s.up)("CcCheckbox"),v=(0,s.up)("TButton"),g=(0,s.up)("TextureInfo");return(0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",l,[(0,s._)("div",c,[(0,s._)("div",null,"纹理数量："+(0,i.zw)(e.count),1),u,(0,s.Wm)(f,{onChange:e.onChangeLook,label:"只看重复"},null,8,["onChange"]),(0,s.Wm)(v,{onConfirm:e.onClickFresh,svg:n(89629)},null,8,["onConfirm","svg"])]),(0,s._)("div",d,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.textures,((e,t)=>((0,s.wg)(),(0,s.j4)(g,{key:t,data:e},null,8,["data"])))),128))])])])}var p=n(2262);const f=["src"];function v(e,t,n,o,a,r){return(0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["btn",{"btn-press":e.isPress,"btn-disabled":e.disabled}]),draggable:"false",onMousedown:t[0]||(t[0]=t=>{e.isPress=!e.disabled}),onMouseup:t[1]||(t[1]=t=>{e.isPress=!1}),onMouseleave:t[2]||(t[2]=t=>e.isPress=!1),onClick:t[3]||(t[3]=(...t)=>e.onClick&&e.onClick(...t))},[e.svgPath?((0,s.wg)(),(0,s.iD)("img",{key:0,src:e.svgPath,style:(0,i.j5)(e.imgStyle),alt:""},null,12,f)):(0,s.kq)("",!0),(0,s.WI)(e.$slots,"default",{},void 0,!0)],34)}var g=(0,s.aZ)({name:"t-button",emits:["confirm"],props:{svg:{type:String,default:""},text:{type:String,default:""},size:{type:Number,default:30},disabled:{type:Boolean,default:!1}},setup(e,{emit:t}){const n=(0,p.iH)(e.svg),o=(0,p.iH)(!1),i=(0,s.Fl)((()=>`width:${e.size}px; height:${e.size}px;`));return{imgStyle:i,isPress:o,svgPath:n,onClick(){e.disabled||t("confirm")}}}}),y=n(83744);const w=(0,y.Z)(g,[["render",v],["__scopeId","data-v-7c4a2f32"]]);var b=w,m=n(82482),k=n(85858),x=n(7597),_=n.n(x);class C{constructor(e){(0,m.Z)(this,"id",""),(0,m.Z)(this,"isReady",!1),(0,m.Z)(this,"rpcList",{}),(0,m.Z)(this,"url","ws://localhost:2022"),(0,m.Z)(this,"ws",null),(0,m.Z)(this,"messages",[]),this.id=e}onMessage(e){console.log(k.ZP.yellow("message",e.data));let t=JSON.parse(e.data),{action:n,data:o,rpc:s,from:i,to:a}=t;const r=this.rpcList[s];if(r)try{const e=JSON.parse(o);r(e),delete this.rpcList[s]}catch(l){console.error(l)}else console.warn("invalid action",n)}_sendMessage(e){this.ws?this.ws.send(JSON.stringify(e)):console.warn("Not connected to server, can not send data")}dispatch(e){const t=_().generate(),n={from:this.id,to:e.panel,rpc:t,type:"dispatch",action:e.action,data:JSON.stringify(e.data||{})};this.rpcList[t]=e.response||(e=>{}),this._sendMessage(n)}register(){this._sendMessage({type:"register",to:this.id})}async init(){return new Promise(((e,t)=>{let n=new WebSocket(this.url);n.onopen=()=>{console.log("open"),this.isReady=!0,this.register(),e(0)},n.onmessage=this.onMessage.bind(this),n.onerror=()=>{this.isReady=!1,this.ws=null,console.log("error"),e(2)},n.onclose=()=>{this.isReady=!1,this.ws=null,console.log("onclose"),e(1)},this.ws=n}))}}const O=e=>((0,s.dD)("data-v-40c6de68"),e=e(),(0,s.Cn)(),e),P={class:"text"},S=O((()=>(0,s._)("div",{style:{flex:"1"}},null,-1))),Z={key:0,class:"details"},j={class:"text",style:{"user-select":"text"}},M=["src"];function D(e,t,n,a,r,l){return(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:(0,i.C_)(["texture",{"texture-repeat":e.data.repeat}])},[(0,s._)("div",{class:(0,i.C_)(["head",{head_under_line:e.isExpand()}]),onClick:t[0]||(t[0]=t=>{e.expand=!e.expand})},[(0,s._)("div",P," key: "+(0,i.zw)(e.data.key),1),S,(0,s._)("div",null,(0,i.zw)(e.data.width)+"*"+(0,i.zw)(e.data.height),1)],2),e.isExpand()?((0,s.wg)(),(0,s.iD)("div",Z,[(0,s._)("div",j," 路径："+(0,i.zw)(e.data.path),1),(0,s._)("img",{src:e.data.url},null,8,M)])):(0,s.kq)("",!0)],2)),[[o.F8,e.show]])}var z=n(74279);const T=new z.TinyEmitter;function H(e,t){T.on(e,t)}function I(e,t){T.off(e,t)}function L(e,t){T.emit(e,t)}const N="look-repeat";var W=(0,s.aZ)({name:"texture-info",props:{data:{type:Object,default:()=>({key:"",path:"",url:"",width:0,height:0,repeat:!1})}},setup(e,{emit:t}){const n=(0,p.iH)(!1);function o(t){i.value=!t||e.data?.repeat}(0,s.bv)((()=>{H(N,o)})),(0,s.Ah)((()=>{I(N,o)}));const i=(0,p.iH)(!0);return{show:i,expand:n,isExpand(t){return e.data.path&&n.value}}}});const B=(0,y.Z)(W,[["render",D],["__scopeId","data-v-40c6de68"]]);var E=B;const F={class:"checkbox"},J={key:0,class:"text"};function R(e,t,n,a,r,l){return(0,s.wg)(),(0,s.iD)("div",F,[(0,s.wy)((0,s._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.val=t),onChange:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t))},null,544),[[o.e8,e.val]]),e.label.length?((0,s.wg)(),(0,s.iD)("span",J,(0,i.zw)(e.label),1)):(0,s.kq)("",!0),(0,s.WI)(e.$slots,"label",{},void 0,!0)])}var $=(0,s.aZ)({name:"cc-checkbox",emits:["update:value","change"],props:{value:{type:Boolean,default:!1},label:{type:String,default:""}},setup(e,{emit:t}){const n=(0,p.iH)(e.value);return(0,s.YP)((()=>e.value),(e=>{n.value=e})),{val:n,onChange(){const e=n.value;t("update:value",e),t("change",e)}}}});const q=(0,y.Z)($,[["render",R],["__scopeId","data-v-22a9404a"]]);var A=q;const Y="editor";var K=(0,s.aZ)({name:"app",components:{CcCheckbox:A,TextureInfo:E,TButton:b},setup(e){const t=(0,p.iH)(0),n=(0,p.iH)([]),o=new C("cache-info");function i(){o.dispatch({panel:Y,action:"get-texture-cache-info-list",response:e=>{const o=e.data;n.value=[];const s=[],i={};for(let t in o){const e=o[t],n={key:t,repeat:!1,url:e.url,path:e.path,width:e.width,height:e.height};s.push(n);const{width:a,height:r,path:l,url:c}=e;l&&(void 0===i[l]&&(i[l]=[]),i[l].push(n))}for(let t in i){const e=i[t];if(e.length>1)for(let n=0;n<e.length;n++)i[t][n].repeat=!0}s.sort(((e,t)=>{const n=Math.min(e.key.length,t.key.length);let o=0;while(o<n){const n=e.key.charCodeAt(o),s=t.key.charCodeAt(o);if(n!==s)return n-s;o++}return 0})),n.value=s,t.value=s.length||0}})}return(0,s.bv)((async()=>{await o.init(),i()})),{count:t,textures:n,onClickFresh(){i()},onChangeLook(e){L(N,e)}}}});const U=(0,y.Z)(K,[["render",h],["__scopeId","data-v-26879810"]]);var V=U,G=n(95684);(0,o.ri)(V).use((0,G.WB)()).mount("#app")},89629:function(e,t,n){e.exports=n.p+"img/fresh.315674fe.svg"}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,o,s,i){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],s=e[u][1],i=e[u][2];for(var r=!0,l=0;l<o.length;l++)(!1&i||a>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(r=!1,i<a&&(a=i));if(r){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,s,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.e=function(){return Promise.resolve()}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.j=762}(),function(){n.p=""}(),function(){var e={762:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var s,i,a=o[0],r=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(l)var u=l(n)}for(t&&t(o);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=self["webpackChunkrich_text_editor"]=self["webpackChunkrich_text_editor"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[4998],(function(){return n(36347)}));o=n.O(o)})();