(function(){"use strict";var e={73032:function(e,t,n){var o=n(49963),a=n(66252);const i={class:"panel"},l=["srcdoc"];function r(e,t,n,o,r,s){const c=(0,a.up)("ToolBar"),u=(0,a.up)("TPopper"),d=(0,a.up)("TDialog");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(c,{class:"toolbar"}),(0,a._)("iframe",{class:"frame",srcdoc:e.frameSource,ref:"frame"},null,8,l),(0,a.kq)("",!0),(0,a.Wm)(u),(0,a.Wm)(d)])}var s=n(2262);const c={class:"toolbar"},u={style:{display:"flex","flex-direction":"row"}},d=(0,a.Uk)(" 字号： "),g={class:"board"},p=(0,a.Uk)(" 颜色： ");function m(e,t,i,l,r,s){const m=(0,a.up)("TButton"),h=(0,a.up)("TSelect"),f=(0,a.up)("TInputNumber"),v=(0,a.up)("TColor"),C=(0,a.up)("HrHandler"),y=(0,a.up)("TSettings");return(0,a.wg)(),(0,a.iD)("div",c,[(0,a.kq)("",!0),(0,a.kq)("",!0),(0,a.Wm)(m,{svg:n(27654),disabled:e.disabledBold,"onUpdate:disabled":t[0]||(t[0]=t=>e.disabledBold=t),onConfirm:e.onBold,title:"对选中内容加粗"},null,8,["svg","disabled","onConfirm"]),(0,a.Wm)(m,{svg:n(38548),disabled:e.disabledItalic,"onUpdate:disabled":t[1]||(t[1]=t=>e.disabledItalic=t),onConfirm:e.onItalic,title:"对选中内容倾斜"},null,8,["svg","disabled","onConfirm"]),(0,a.Wm)(m,{svg:n(22241),disabled:e.disabledUnderline,"onUpdate:disabled":t[2]||(t[2]=t=>e.disabledUnderline=t),onConfirm:e.onUnderline,title:"对选中内容添加下划线"},null,8,["svg","disabled","onConfirm"]),(0,a.Wm)(m,{svg:n(24580),disabled:e.disabledDelete,"onUpdate:disabled":t[3]||(t[3]=t=>e.disabledDelete=t),onConfirm:e.onStrikeThrough,title:"对选中内容添加删除线"},null,8,["svg","disabled","onConfirm"]),(0,a.kq)("",!0),(0,a._)("div",u,[d,(0,a.Wm)(h,{data:e.fontSizeCfg,style:{width:"100px"},value:e.curFontSizeStr,"onUpdate:value":t[5]||(t[5]=t=>e.curFontSizeStr=t),onChange:e.onChangeFontSizeStr},null,8,["data","value","onChange"])]),(0,a.wy)((0,a.Wm)(f,{class:"board",value:e.curFontSize,"onUpdate:value":t[6]||(t[6]=t=>e.curFontSize=t),title:"字号",onChange:e.onChangeFontSize},null,8,["value","onChange"]),[[o.F8,!1]]),(0,a._)("div",g,[p,(0,a.Wm)(v,{onChange:e.onChangColor},null,8,["onChange"])]),(0,a.Wm)(m,{svg:n(58991),onConfirm:e.onShowLink,title:"对选中内容添加超链接"},null,8,["svg","onConfirm"]),(0,a.Wm)(m,{svg:n(9396),onConfirm:e.onInsertImg,title:"在当前位置插入图片"},null,8,["svg","onConfirm"]),(0,a.Wm)(C),(0,a.Wm)(m,{svg:n(65251),onConfirm:e.onRemoveFormat,title:"清楚选中内容的所有样式"},null,8,["svg","onConfirm"]),(0,a.Wm)(m,{svg:n(44319),size:20,onConfirm:e.onImport,title:"导入"},null,8,["svg","onConfirm"]),(0,a.Wm)(m,{svg:n(88420),size:20,onConfirm:e.onExport,title:"导出"},null,8,["svg","onConfirm"]),(0,a.Wm)(m,{svg:n(65932),size:20,onConfirm:e.onSetRefBg,title:"设置参考背景图"},null,8,["svg","onConfirm"]),(0,a.Wm)(y),(0,a.kq)("",!0)])}var h=n(3577);const f=["src"];function v(e,t,n,o,i,l){return(0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["btn",{"btn-press":e.isPress,"btn-disabled":e.disabled}]),draggable:"false",onMousedown:t[0]||(t[0]=t=>{e.isPress=!e.disabled}),onMouseup:t[1]||(t[1]=t=>{e.isPress=!1}),onMouseleave:t[2]||(t[2]=t=>e.isPress=!1),onClick:t[3]||(t[3]=(...t)=>e.onClick&&e.onClick(...t))},[e.svgPath?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.svgPath,style:(0,h.j5)(e.imgStyle),alt:""},null,12,f)):(0,a.kq)("",!0),(0,a.WI)(e.$slots,"default",{},void 0,!0)],34)}var C=(0,a.aZ)({name:"t-button",emits:["confirm"],props:{svg:{type:String,default:""},text:{type:String,default:""},size:{type:Number,default:30},disabled:{type:Boolean,default:!1}},setup(e,{emit:t}){const n=(0,s.iH)(e.svg),o=(0,s.iH)(!1),i=(0,a.Fl)((()=>`width:${e.size}px; height:${e.size}px;`));return{imgStyle:i,isPress:o,svgPath:n,onClick(){e.disabled||t("confirm")}}}}),y=n(83744);const b=(0,y.Z)(C,[["render",v],["__scopeId","data-v-7c4a2f32"]]);var w=b;const S=["value"];function x(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.curValue=t),onChange:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t)),style:{width:"100%"}},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.data,((e,t)=>((0,a.wg)(),(0,a.iD)("option",{key:t,value:e.value},(0,h.zw)(e.label),9,S)))),128))],544),[[o.bM,e.curValue]])])}var _=(0,a.aZ)({name:"t-select",props:{data:{type:Array,required:!0,default(){return[]}},value:String},emits:["change","update:data","update:value"],setup(e,{emit:t}){const n=(0,s.iH)(e.value||"");return(0,a.YP)((()=>e.value),(e=>{n.value=e})),{curValue:n,onChange(){t("update:value",n.value.toString()),t("change")}}}});const k=(0,y.Z)(_,[["render",x]]);var H=k;const T={class:"root"};function E(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",T,[(0,a.Uk)((0,h.zw)(e.title)+" ",1),(0,a.wy)((0,a._)("input",{style:{width:"30px"},onChange:t[0]||(t[0]=(...t)=>e.onChange&&e.onChange(...t)),"onUpdate:modelValue":t[1]||(t[1]=t=>e.curData=t)},null,544),[[o.nr,e.curData]])])}var I=(0,a.aZ)({name:"t-input",props:{title:String,data:String},emits:["change","update:data"],setup(e,{emit:t}){const n=(0,s.iH)(e.data);return{curData:n,onChange(){t("update:data",n.value),t("change")}}}});const B=(0,y.Z)(I,[["render",E],["__scopeId","data-v-62243f74"]]);var D=B;const z={class:"root"},M=["src"],W=["src"];function L(e,t,i,l,r,s){const c=(0,a.up)("TInputNumber");return(0,a.wg)(),(0,a.iD)("div",z,[(0,a.wy)((0,a._)("img",{class:"lock",onClick:t[0]||(t[0]=(...t)=>e.onChangeLock&&e.onChangeLock(...t)),src:n(24990),alt:""},null,8,M),[[o.F8,e.fixSize]]),(0,a.wy)((0,a._)("img",{class:"lock",onClick:t[1]||(t[1]=(...t)=>e.onChangeLock&&e.onChangeLock(...t)),src:n(65446),alt:""},null,8,W),[[o.F8,!e.fixSize]]),(0,a.Wm)(c,{style:{"margin-right":"2px"},value:e.fixWidth,"onUpdate:value":t[2]||(t[2]=t=>e.fixWidth=t),title:"宽",onChange:e.onChangeWidth},null,8,["value","onChange"]),(0,a.Wm)(c,{title:"高",value:e.fixHeight,"onUpdate:value":t[3]||(t[3]=t=>e.fixHeight=t),onChange:e.onChangeHeight},null,8,["value","onChange"])])}var U=n(95684);const F={Command:{Bold:"bold",Italic:"italic",Underline:"underline",Delete:"strikeThrough"},Alignment:{Horizontal:{Left:0,Center:1,Right:2},Vertical:{Top:0,Center:1,Bottom:2}},Provide:{UpdateConfig:"UpdateConfig",ShowImgHandler:"ShowImgHandler",UpdateBgColor:"UpdateBgColor",UpdateDebugBoard:"UpdateDebugBoard",SetRefBg:"SetRefBg"},Msg:{ShowPopper:"ShowPopper",UpdateCommandState:"UpdateCommandState"}};var P=F;const R=(0,U.Q_)("app",{state:()=>({xml:"",fixSize:!0,defaultFontSize:20,fixWidth:100,fixHeight:100,lineSpace:0,alignmentHorizontal:P.Alignment.Horizontal.Left,alignmentVertical:P.Alignment.Vertical.Top,bgColor:"#000000",debugBoard:!0}),actions:{changeLineSpace(e){this.lineSpace=e,this._change()},_change(){}}});var Z=R;const O={class:"cc-input-number"};function N(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",O,[(0,a._)("label",null,[(0,a.Uk)((0,h.zw)(e.title)+" ",1),(0,a.wy)((0,a._)("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=t=>e.val=t),type:"number",onChange:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t))},null,544),[[o.nr,e.val]])])])}var A=(0,a.aZ)({name:"t-input-number",emits:["change","update:value"],props:{title:String,disabled:{type:Boolean,default:!1},value:{type:Number,required:!0,default:0},min:{type:Number},max:{type:Number},step:{type:Number}},setup(e,{emit:t}){const n=(0,s.iH)(),o=(0,s.iH)(parseFloat(e.value.toFixed(2).toString()));(0,a.YP)((()=>e.value),(()=>{let t=e.value;"string"===typeof t&&(t=parseFloat(t)),o.value=parseFloat(t.toFixed(2).toString())})),(0,a.bv)((()=>{void 0!==e.min&&n.value.setAttribute("min",e.min.toString()),void 0!==e.max&&n.value.setAttribute("max",e.max.toString()),void 0!==e.step&&n.value.setAttribute("step",e.step.toString())}));let i=(0,s.IU)(e.value);return{val:o,input:n,onChange(){""===o.value.toString()&&(o.value=i),i=o.value,t("update:value",o.value),t("change",o.value)}}}});const V=(0,y.Z)(A,[["render",N],["__scopeId","data-v-a5c7caaa"]]);var $=V,j=(0,a.aZ)({name:"t-size",components:{TInputNumber:$,TInput:D},props:{},setup(e,{emit:t}){const n=Z(),{fixSize:o,fixHeight:i,fixWidth:l}=(0,U.Jk)(n),r=(0,a.f3)(P.Provide.UpdateConfig,(e=>{}));return{fixSize:o,fixWidth:l,fixHeight:i,onChangeWidth(){n.fixWidth=l.value,r("")},onChangeHeight(){n.fixHeight=i.value,r("")},onChangeLock(){n.fixSize=!o.value,r("")}}}});const q=(0,y.Z)(j,[["render",L],["__scopeId","data-v-d8596426"]]);var X=q;const J={class:"cc-color"},K={class:"colors"};function Y(e,t,n,i,l,r){const s=(0,a.up)("ColorSaturation"),c=(0,a.up)("Hue"),u=(0,a.up)("ColorInput"),d=(0,a.up)("ColorCase");return(0,a.wg)(),(0,a.iD)("div",J,[(0,a._)("div",{class:"color",style:(0,h.j5)(e.style),onClick:t[0]||(t[0]=(0,o.iM)(((...t)=>e.onShowPanel&&e.onShowPanel(...t)),["stop","prevent"])),onMousedown:t[1]||(t[1]=(0,o.iM)((()=>{}),["stop","prevent"]))},null,36),(0,a.wy)((0,a._)("div",{class:"color-panel",onClick:t[4]||(t[4]=(0,o.iM)((()=>{}),["stop","prevent"]))},[(0,a.Wm)(s,{ref:"saturationComp",color:e.hexColor,onChange:e.onColorChangeSaturation},null,8,["color","onChange"]),(0,a.Wm)(c,{class:"board",title:"",hue:e.hueValue,"onUpdate:hue":t[2]||(t[2]=t=>e.hueValue=t),onChange:e.onChangeColorHue},null,8,["hue","onChange"]),(0,a.Wm)(u,{title:"HEX:",color:e.hexColor,"onUpdate:color":t[3]||(t[3]=t=>e.hexColor=t),onChange:e.onColorChangeHex,onFocusin:e.onFocusin},null,8,["color","onChange","onFocusin"]),(0,a._)("div",K,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.colorList,((t,n)=>((0,a.wg)(),(0,a.j4)(d,{class:"color-item",onClick:(0,o.iM)((n=>e.onColorListSelect(t)),["prevent","stop"]),key:n,color:t},null,8,["onClick","color"])))),128))])],512),[[o.F8,e.show]])])}const G=e=>((0,a.dD)("data-v-3e6ba21a"),e=e(),(0,a.Cn)(),e),Q={class:"root"},ee=G((()=>(0,a._)("div",{class:"bg"},null,-1))),te={class:"pointer",ref:"pointer"},ne=G((()=>(0,a._)("div",{class:"shape"},null,-1))),oe=[ne];function ae(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",Q,[(0,a._)("div",{class:"hue",ref:"hueEl",onMousedown:t[0]||(t[0]=(0,o.iM)(((...t)=>e.onHueMouseDown&&e.onHueMouseDown(...t)),["self"]))},[ee,(0,a._)("div",te,oe,512)],544)])}var ie=(0,a.aZ)({name:"color-hue",emits:["change","update:hue"],props:{title:{type:String,default:"颜色"},hue:{type:Number,default:0}},setup(e,{emit:t}){const n=(0,s.iH)(),o=(0,s.iH)();function i(e){const t=o.value;t.style.left=e/360*100+"%"}return(0,a.YP)((()=>e.hue),(e=>{i(e)})),(0,a.bv)((()=>{i(e.hue)})),{hueEl:n,pointer:o,onHueMouseDown(e){const a=o.value,i=n.value.getBoundingClientRect(),l=e=>{let n=(e.clientX-i.left)/i.width*100;n=n>100?100:n,n=n<0?0:n,a.style.left=`${n}%`;const o=n/100*360;t("update:hue",o),t("change",o)};let r=e=>{document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",l),document.addEventListener("mouseup",r),l(e)}}}});const le=(0,y.Z)(ie,[["render",ae],["__scopeId","data-v-3e6ba21a"]]);var re=le;const se={class:"root"},ce={class:"title"};function ue(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",se,[(0,a._)("div",ce,(0,h.zw)(e.curTitle),1),(0,a.wy)((0,a._)("input",{class:"input",draggable:"false",onKeydown:t[0]||(t[0]=(0,o.D2)(((...t)=>e.onKeyDown&&e.onKeyDown(...t)),["enter"])),onPaste:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t)),"onUpdate:modelValue":t[2]||(t[2]=t=>e.curColor=t),onChange:t[3]||(t[3]=(...t)=>e.onChange&&e.onChange(...t))},null,544),[[o.nr,e.curColor]])])}var de=n(17621),ge=n.n(de);function pe(e){return ge()(e).toHsv().h}function me(e,t){const n=ge()(e).toHsv(),o=ge()().toHsv();o.h=t,o.s=n.s,o.v=n.v;const a=ge()(o);return a.toHex8()}function he(e,t,n){const o=ge()(e),a=o.toHsv();return a.s=t,a.v=n,ge()(a).toHex8()}function fe(e){const t=ge()().toHsv();return t.h=e,t.s=1,t.v=1,ge()(t).toHex()}function ve(e){return ge()(e).toHsv()}function Ce(e,t){const n=ge()(e),o=n.toHsl();o.a=t;const a=ge()(o);return a.toHex8()}function ye(e){const t=ge()(e);return`#${t.toHex()}`}function be(e){const t=ge()(e);return`#${t.toHex8()}`}function we(e){const t=ge()(e);return t.isValid()?t.toHex8():null}var Se=(0,a.aZ)({name:"color-input",emits:["change","update:color"],props:{title:{type:String,default:""},color:{type:String,default:"#818181"}},setup(e,{emit:t}){const n=(0,s.iH)(e.color),o=(0,s.iH)(e.title);let i=(0,s.IU)(e.color);function l(e){return e.startsWith("#")||(e=`#${e}`),e}function r(e){const t=we(e);return t?(n.value=i=l(t),!0):(n.value=i=l(i),!1)}return(0,a.YP)((()=>e.color),(e=>{r(e)})),{curColor:n,curTitle:o,onKeyDown(e){e.target.blur()},onChange(){if(r(n.value)){const e=n.value;t("update:color",e),t("change",e)}}}}});const xe=(0,y.Z)(Se,[["render",ue],["__scopeId","data-v-5c0595e7"]]);var _e=xe;const ke=e=>((0,a.dD)("data-v-10bc0a5d"),e=e(),(0,a.Cn)(),e),He={class:"root"},Te={class:"title"},Ee={class:"pointer",ref:"pointer"},Ie=ke((()=>(0,a._)("div",{class:"shape"},null,-1))),Be=[Ie];function De(e,t,n,i,l,r){const s=(0,a.up)("AlphaBoard");return(0,a.wg)(),(0,a.iD)("div",He,[(0,a._)("div",Te,(0,h.zw)(e.curTitle),1),(0,a._)("div",{class:"hue",ref:"hue",onMousedown:t[0]||(t[0]=(0,o.iM)(((...t)=>e.onHueMouseDown&&e.onHueMouseDown(...t)),["self"]))},[(0,a.Wm)(s,{class:"alpha"}),(0,a._)("div",{class:"bg",style:(0,h.j5)(e.style)},null,4),(0,a._)("div",Ee,Be,512)],544)])}function ze(e,t,n,o,i,l){return(0,a.wg)(),(0,a.iD)("div",{class:"board",style:(0,h.j5)(e.bgStyle)},null,4)}var Me=(0,a.aZ)({name:"alpha-board",props:{size:{type:Number,default:4},white:{type:String,default:"#fff"},grey:{type:String,default:"#e6e6e6"}},setup(e,{emit:t}){function n(e,t,n){if("undefined"===typeof document)return"";const o=document.createElement("canvas");o.width=o.height=2*n;const a=o.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,o.width,o.height),a.fillStyle=t,a.fillRect(0,0,n,n),a.translate(n,n),a.fillRect(0,0,n,n),o.toDataURL()):""}const o=(0,a.Fl)((()=>{const t=n(e.white,e.grey,e.size);return`background-image:url(${t})`}));return{bgStyle:o}}});const We=(0,y.Z)(Me,[["render",ze],["__scopeId","data-v-14da3668"]]);var Le=We,Ue=(0,a.aZ)({name:"color-alpha",components:{AlphaBoard:Le},emits:["change","update:color"],props:{title:{type:String,default:"颜色"},color:{type:String,default:"red"}},setup(e,{emit:t}){const n=(0,s.iH)(),o=(0,s.iH)(),i=(0,s.iH)(e.title),l=(0,a.Fl)((()=>{let t=ye(e.color);return`background: linear-gradient(to right, transparent 0%, ${t} 100%)`}));return{style:l,hue:n,pointer:o,curTitle:i,onHueMouseDown(a){const i=n.value,l=o.value,r=i.getBoundingClientRect();let s=n=>{let o=(n.clientX-r.left)/r.width*100;o=o>100?100:o,o=o<0?0:o,l.style.left=`${o}%`;const a=Ce(e.color,o/100);t("update:color",a),t("change",a)},c=e=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",s),document.addEventListener("mouseup",c),s(a)}}}});const Fe=(0,y.Z)(Ue,[["render",De],["__scopeId","data-v-10bc0a5d"]]);var Pe=Fe;const Re=e=>((0,a.dD)("data-v-28a495cc"),e=e(),(0,a.Cn)(),e),Ze=Re((()=>(0,a._)("div",{class:"white",draggable:"false"},null,-1))),Oe=Re((()=>(0,a._)("div",{class:"black",draggable:"false"},null,-1))),Ne={class:"pointer",ref:"pointer",draggable:"false"},Ae=Re((()=>(0,a._)("div",{class:"shape1",draggable:"false"},null,-1))),Ve=Re((()=>(0,a._)("div",{class:"shape2",draggable:"false"},null,-1))),$e=[Ae,Ve];function je(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",{class:"picker",draggable:"false",ref:"picker",style:(0,h.j5)({background:e.bgColor}),onMousedown:t[0]||(t[0]=(0,o.iM)(((...t)=>e.onPickerPointerMouseDown&&e.onPickerPointerMouseDown(...t)),["self"]))},[Ze,Oe,(0,a._)("div",Ne,$e,512)],36)}var qe=(0,a.aZ)({name:"color-saturation",emits:["change","update:color"],props:{color:{type:String,default:"red"}},setup(e,{emit:t}){const n=(0,s.iH)(),o=(0,s.iH)(),i=(0,s.iH)("red");let l=(0,s.IU)(e.color);function r(e){l=e,c(e)}function c(e){const t=o.value,{s:n,v:a}=ve(e);t.style.left=100*n+"%",t.style.top=100*(1-a)+"%";const l=pe(e);i.value=`#${fe(l)}`}return(0,a.YP)((()=>e.color),(e=>{c(e)})),(0,a.bv)((()=>{c(e.color)})),{bgColor:i,pointer:o,picker:n,updateBaseColor:r,onPickerPointerMouseDown(e){let a=e=>{const a=o.value,i=n.value,r=i.getBoundingClientRect();let s=(e.clientX-r.left)/r.width*100;s=s>100?100:s,s=s<0?0:s,a.style.left=`${s}%`;let c=(e.clientY-r.top)/r.height*100;c=c>100?100:c,c=c<0?0:c,a.style.top=`${c}%`;let u=s/100,d=1-c/100,g=he(l,u,d);t("update:color",g),t("change",g)},i=e=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",i)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",i),a(e)}}}});const Xe=(0,y.Z)(qe,[["render",je],["__scopeId","data-v-28a495cc"]]);var Je=Xe;function Ke(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",{class:"color-case",onMouseenter:t[0]||(t[0]=t=>e.isHover=!0),onMouseleave:t[1]||(t[1]=t=>e.isHover=!1),style:(0,h.j5)({backgroundColor:`#${e.colorHex}`})},[(0,a.wy)((0,a._)("div",{class:"label",style:(0,h.j5)({color:`#${e.labelColor}`})},"#"+(0,h.zw)(e.colorHex),5),[[o.F8,e.isHover]])],36)}var Ye=(0,a.aZ)({name:"color-case",props:{color:{type:String,default:"red"}},setup(e,{emit:t}){const n=ge()(e.color),o=(0,s.iH)(n.toHex()),a=n.toRgb();a.r=255-a.r,a.g=255-a.g,a.b=255-a.b;const i=ge()(a);i.darken(40);const l=(0,s.iH)(i.toHex()),r=(0,s.iH)(!1);return{isHover:r,colorHex:o,labelColor:l}}});const Ge=(0,y.Z)(Ye,[["render",Ke],["__scopeId","data-v-b60fb784"]]);var Qe=Ge,et=(0,a.aZ)({name:"t-color",emits:["update:color","change"],components:{ColorCase:Qe,ColorSaturation:Je,ColorInput:_e,Hue:re,Alpha:Pe},props:{color:{type:String,default:"#ff0000ff"},alpha:{type:Boolean,default:!1}},setup(e,{emit:t}){const n=(0,s.iH)(!1),o=(0,s.iH)(e.color),i=(0,s.iH)(pe(e.color)),l=(0,a.Fl)((()=>({backgroundColor:`${ye(e.color)}`})));function r(){const e=o.value,n=be(e),a=ye(e);l.value.backgroundColor=`${n}`,t("update:color",n),t("change",a,n)}(0,a.bv)((()=>{document.addEventListener("click",(()=>{n.value=!1}))})),(0,a.YP)((()=>e.color),(e=>{o.value=e}));const c=(0,s.iH)(["#39352f","#43aa05","#cf2831","#2297fe","#dc50ff","#ff6400","#e6dcc8","#f8b551","#b6ada1","#87501e"]),u=(0,s.iH)();return{saturationComp:u,colorList:c,hexColor:o,hueValue:i,style:l,show:n,onShowPanel(){n.value=!n.value,n.value&&(i.value=pe(o.value),u.value.updateBaseColor(o.value))},onColorChangeSaturation(e){o.value=e,r()},onChangeColorHue(e){o.value=me(o.value,i.value),u.value.updateBaseColor(o.value),r()},onColorChangeHex(e){o.value=e,i.value=pe(e),u.value.updateBaseColor(o.value),r()},onColorListSelect(e){o.value=e,i.value=pe(e),u.value.updateBaseColor(o.value),r(),n.value=!1},onFocusin(e){e.target.select()}}}});const tt=(0,y.Z)(et,[["render",Y],["__scopeId","data-v-5e3fc242"]]);var nt=tt,ot=n(82482);const at={loadFont(e,t){let n=document.createElement("style");n.type="text/css",n.innerText=`@font-face {font-family: ${e}; src:url('${t}')}`,document.head.appendChild(n)},parseStyle(e){const t={};let n=e.split(";");return n.forEach((e=>{if(-1!==e.indexOf(":")){let[n,o]=e.split(":");n=n.trim(),o=o.trim(),n&&(t[n]=o)}})),t},seepFrameEvent(){const e=document.getElementsByTagName("iframe");for(let t=0;t<e.length;t++){const n=e.item(t);n&&n.contentWindow?n.contentWindow.addEventListener("load",(()=>{["mousedown","click"].map((e=>{n.contentDocument&&n.contentDocument.addEventListener(e,(e=>{const t=document.createEvent("MouseEvent");t.initEvent(e.type),document.dispatchEvent(t)}))}))})):console.log("failed")}},getElementFontSize(e){let t=getComputedStyle(e).fontSize;return t?this.subTail(t,"px",!0):null},subTail(e,t,n=!1){let o=e;return e.endsWith(t)&&(o=e.substring(0,e.length-t.length)),n&&(o=o.trim()),o},fillTail(e,t){return e.endsWith(t)?e:e+t}};var it,lt=at,rt=n(74279);(function(e){e[e["Top"]=0]="Top",e[e["Bottom"]=1]="Bottom"})(it||(it={}));var st=n.p+"fonts/default.b59774de.ttf";class ct{constructor(){(0,ot.Z)(this,"emitter",new rt.TinyEmitter),(0,ot.Z)(this,"_contentElement",null),(0,ot.Z)(this,"_frame",null),(0,ot.Z)(this,"_callbackList",{}),(0,ot.Z)(this,"_record",{startContainer:null,startOffset:0,endContainer:null,endOffset:0})}init(e){e.contentEditable="true",this._contentElement=e}execCommand(e,t=""){const n=this.getDocument();n&&n.execCommand(e,!1,t)}insertHR(e="#fff",t=1,n=2){const o=this.getRange(),a=this.getDocument();if(o&&a){const i=a.createElement("hr");i.style.background=e,i.style.height=`${t}px`,i.style.margin=`${n}px 0`,o.insertNode(i)}}selectEnd(){const e=this.getRange(),t=this.getDocument();if(e&&t&&this._contentElement){let n=t.body.childNodes.length;e.setStart(this._contentElement,n),e.setEnd(this._contentElement,n),e.collapse(!0)}}_queryCommand(){const e="createLink",t=this.getDocument();if(t){t.queryCommandEnabled(e),t.queryCommandState(e);let n=t.queryCommandValue(e);return console.log(111),n}return null}getHref(e){return e&&"a"===e.nodeName.toLowerCase()&&e.getAttribute("href")||null}getSelectContentLink(){let e=null;const t=this.getSelectTag();return t&&t.el&&(e=this.getHref(t.el),e||(e=this.getHref(t.el.parentElement))),e}setImageSize(e,t){if(this.isSelectImgTag()){const n=this.getSelectTag();if(n){const o=n.el;o.setAttribute("width",`${e}px`),o.setAttribute("height",`${t}px`)}}}onSelectTag(e){}isSelectImgTag(){const e=this.getSelectTag();return!(!e||"img"!==e.tag)}isSelectLinkTag(){const e=this.getSelectTag();return!(!e||"a"!==e.tag)}getSelectTag(){const e={tag:"text"},t=this.getRange();if(t&&!t.collapsed)if(t.startContainer===t.endContainer){if(this.rangeStartIsType())return e.el=t.startContainer,e;{let n=t.commonAncestorContainer.childNodes[t.startOffset];if(n)return e.tag=n.nodeName.toLowerCase(),e.el=n,e}}else{const n=this.rangeStartIsType()&&this.rangeEndIsType();if(n)return e;{const n=t.startContainer.parentElement;if(n)return e.tag=n.nodeName.toLowerCase(),e.el=n,e}}return null}getPopperPositionBySelect(){const e=this.getSelectRect();if(!e)return{x:0,y:0};let t=0,n=0,o=0,a=0;if(this._frame){const e=this._frame.getBoundingClientRect();getComputedStyle(this._frame);t=e.x,n=e.y,o=this._frame.contentDocument?.body.scrollLeft||0,a=this._frame.contentDocument?.body.scrollTop||0}const i=e.x+t+o;let l=e.y+e.height+n,r=it.Bottom;return l<document.body.clientHeight/2?(r=it.Bottom,{x:i,y:l,type:r}):(l=e.y+n,r=it.Top,{x:i,y:l,type:r})}_insertBr(e=1){const t=this.getRange(),n=this.getDocument();if(t&&n)for(let o=1;o<=e;o++){const a=n.createElement("br");if(t.insertNode(a),t.insertNode(n.createTextNode("&nbsp")),e===o)return a}return null}insertBR(){console.log("insertBR");const e=this.getDocument(),t=this.getRange();if(e&&t)if(this.rangeEndIsType())if(t.endContainer===e.body.lastChild){const e=t.endContainer.nodeValue.length,n=t.endOffset;if(e===n){const e=this._insertBr(2);if(e){const n=e.parentElement?.childNodes;if(n)for(let o=0;o<n.length;o++)e===n[o]&&(t.setStart(e.parentElement,o+1),t.setStart(e.parentElement,o+1),t.collapse(!0))}}else{const e=this._insertBr(1);if(e){const n=e.parentElement?.childNodes;if(n)for(let o=0;o<n.length;o++)if(n[o]===e){let e=null,a=o+1;a<n.length&&(e=n[a]),e&&(t.setStart(e,0),t.setEnd(e,0),t.collapse(!0))}}}}else this._insertBr(1);else this._insertBr(1)}_initEvent(){this._contentElement&&(this._contentElement.onkeydown=e=>{if(e.stopImmediatePropagation(),e.stopPropagation(),13===e.keyCode)return this.execCommand("insertHTML","<br>&nbsp"),this.execCommand("delete"),this.focus(),!1},this._contentElement.onmouseup=e=>{setTimeout((()=>{const e=this.getSelectTag();e&&(this.emitter.emit(P.Msg.UpdateCommandState),this.onSelectTag(e))}))})}_watchChange(){}getDocument(){return this._frame?.contentDocument||null}_setDefaultFont(){const e=this.getDocument();if(e){const t=e.createElement("style"),n="game-font";t.innerHTML=`\n            @font-face{\n                font-family:${n};\n                src:url('${st}');\n            }\n            body{\n                font-family:${n};\n            }\n            `,e.head.appendChild(t)}}setBgColor(e){const t=this.getDocument();t&&(t.body.style.backgroundColor=e)}initWithFrame(e,t){return t&&(this._callbackList=t),this._frame=e,new Promise(((t,n)=>{e.onload=()=>{const n=e.contentDocument?.body;n&&(n.contentEditable="true",this._contentElement=n,this._setDefaultFont()),this._initEvent(),t(0)}}))}setInnerHtml(e){this._contentElement&&(this._contentElement.innerHTML=e)}setBaseFontSize(e){this._contentElement&&(this._contentElement.style.fontSize=`${e}px`)}getBaseFontSize(){return this._contentElement?lt.getElementFontSize(this._contentElement):null}getInnerHtml(e=!1){const t=this.getBaseFontSize();let n=this._contentElement?.innerHTML||"";return e?`<font>${n}</font>`:`<font size="${t}">${n}</font>`}recordRange(){const e=this.getRange();e&&(this._record.startContainer=e.startContainer,this._record.startOffset=e.startOffset,this._record.endContainer=e.endContainer,this._record.endOffset=e.endOffset)}recoverRange(){const e=this.getRange(),{startOffset:t,startContainer:n,endOffset:o,endContainer:a}=this._record;e&&n&&a&&(e.setStart(n,t),e.setEnd(a,o))}getSelection(){return this._frame?this._frame.contentWindow?.getSelection():null}getRange(){const e=this.getSelection();if(e){if(e.rangeCount)return e.getRangeAt(0);{const t=document.createRange();return e.addRange(t),t}}return null}get isSelectEmpty(){const e=this.getRange();return!(!e||!e.collapsed)}rangeStartIsType(e=Node.TEXT_NODE){const t=this.getRange();return!(!t||e!==t.startContainer.nodeType)}rangeEndIsType(e=Node.TEXT_NODE){const t=this.getRange();return!(!t||e!==t.endContainer.nodeType)}getSelectRect(){const e=this.getRange();return e&&!e.collapsed?e.getBoundingClientRect():null}getSelectElement(){const e=this.getRange();if(e&&!e.collapsed){if(this.rangeStartIsType())return e.startContainer;{const t=e.commonAncestorContainer.childNodes,n=t[e.startOffset];return n}}return null}isApplyCommandEffect(e){const t=this.getDocument();if(t){const n=t.queryCommandEnabled(e),o=t.queryCommandState(e);t.queryCommandValue(e);return n&&o}return!1}getCommandEffectValue(e){const t=this.getDocument();return t?t.queryCommandValue(e):""}setSelectFontSize(e){if(this.isSelectEmpty)console.log("select empty");else{const t=this.getRange();if(t){let n=null;if(t.startContainer===t.endContainer)if(this.rangeStartIsType())n=document.createElement("font"),n.draggable=!1,t.insertNode(n),t.surroundContents(n);else{const e=t.commonAncestorContainer.childNodes,o=e[t.startOffset];e[t.endOffset];Node.ELEMENT_NODE===o.nodeType&&"font"===o.nodeName.toLowerCase()&&(n=o)}else{console.log("un support");const e=t.cloneContents();this._cleanFontSize(e),t.deleteContents(),n=document.createElement("font"),n.draggable=!1,n.appendChild(e),t.insertNode(n)}n&&(n.style.fontSize=`${e}px`)}}}_cleanFontSize(e){"font"===e.nodeName.toLowerCase()&&e.style.removeProperty("font-size"),e.childNodes.forEach((e=>{this._cleanFontSize(e)}))}focus(){this._contentElement?.focus()}selectAll(){const e=this.getRange();e&&this._contentElement&&this._contentElement.firstChild&&this._contentElement.lastChild&&(e.setStart(this._contentElement.firstChild,0),e.setEnd(this._contentElement.lastChild,0))}test(){const e=this.getRange();if(!e||e.collapsed);else{let t=document.getElementsByClassName("editor")[0];t&&e.setStart(t,1);let n=e.cloneContents(),o=document.createElement("div");o.appendChild(n);let a=o.innerHTML;console.log(a)}}}const ut=new ct;var dt=ut;const gt={class:"settings"},pt={class:"layout"},mt={class:"layout"};function ht(e,t,i,l,r,s){const c=(0,a.up)("TButton"),u=(0,a.up)("TProp"),d=(0,a.up)("TInputNumber"),g=(0,a.up)("TSize"),p=(0,a.up)("TColor"),m=(0,a.up)("TCheckbox");return(0,a.wg)(),(0,a.iD)("div",gt,[(0,a.Wm)(c,{svg:n(70134),title:"设置",onClick:t[0]||(t[0]=(0,o.iM)((t=>{e.isShowSettings=!e.isShowSettings}),["stop","prevent"]))},null,8,["svg"]),(0,a.wy)((0,a._)("div",{class:"details",onClick:t[11]||(t[11]=(0,o.iM)((()=>{}),["stop","self"]))},[(0,a.Wm)(u,{title:"水平对齐：",gray:!0},{default:(0,a.w5)((()=>[(0,a._)("div",pt,[(0,a.Wm)(c,{svg:n(32851),onConfirm:t[1]||(t[1]=t=>e.updateAlignmentHorizontal(e.ConstVar.Alignment.Horizontal.Left))},null,8,["svg"]),(0,a.Wm)(c,{svg:n(78066),onConfirm:t[2]||(t[2]=t=>e.updateAlignmentHorizontal(e.ConstVar.Alignment.Horizontal.Center))},null,8,["svg"]),(0,a.Wm)(c,{svg:n(42482),onConfirm:t[3]||(t[3]=t=>e.updateAlignmentHorizontal(e.ConstVar.Alignment.Horizontal.Right))},null,8,["svg"]),(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(u,{title:"垂直对齐：",gray:!0},{default:(0,a.w5)((()=>[(0,a._)("div",mt,[(0,a.Wm)(c,{svg:n(57937),onConfirm:t[4]||(t[4]=t=>e.updateAlignmentVertical(e.ConstVar.Alignment.Vertical.Top))},null,8,["svg"]),(0,a.Wm)(c,{svg:n(55359),onConfirm:t[5]||(t[5]=t=>e.updateAlignmentVertical(e.ConstVar.Alignment.Vertical.Center))},null,8,["svg"]),(0,a.Wm)(c,{svg:n(55187),onConfirm:t[6]||(t[6]=t=>e.updateAlignmentVertical(e.ConstVar.Alignment.Vertical.Bottom))},null,8,["svg"])])])),_:1}),(0,a.Wm)(u,{title:"行间距："},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{style:{flex:"1"},value:e.lineSpace,"onUpdate:value":t[7]||(t[7]=t=>e.lineSpace=t),onChange:e.onChangeSettings},null,8,["value","onChange"])])),_:1}),(0,a.Wm)(u,{title:"默认字号：",gray:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{value:e.defaultFontSize,"onUpdate:value":t[8]||(t[8]=t=>e.defaultFontSize=t),min:1,onChange:e.onChangeDefaultFontSize},null,8,["value","onChange"])])),_:1}),(0,a.Wm)(u,{title:"尺寸：",gray:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(g)])),_:1}),(0,a.Wm)(u,{title:"背景色：",gray:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{color:e.bgColor,"onUpdate:color":t[9]||(t[9]=t=>e.bgColor=t),onChange:e.changeBgColor},null,8,["color","onChange"])])),_:1}),(0,a.Wm)(u,{title:"显示边框：",gray:!0},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{value:e.debugBoard,"onUpdate:value":t[10]||(t[10]=t=>e.debugBoard=t),onChange:e.onChangeDebugBoard},null,8,["value","onChange"])])),_:1})],512),[[o.F8,e.isShowSettings]])])}const ft={class:"prop"};function vt(e,t,n,o,i,l){return(0,a.wg)(),(0,a.iD)("div",ft,[(0,a._)("div",{class:(0,h.C_)(["title",{"title-gray":e.gray}])},(0,h.zw)(e.title),3),(0,a.WI)(e.$slots,"default",{},void 0,!0)])}var Ct=(0,a.aZ)({name:"t-prop",props:{title:{type:String,default:""},gray:{type:Boolean,default:!1}},setup(e,{emit:t}){}});const yt=(0,y.Z)(Ct,[["render",vt],["__scopeId","data-v-b1b75534"]]);var bt=yt;const wt={class:"checkbox"};function St(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",wt,[(0,a.wy)((0,a._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.val=t),onChange:t[1]||(t[1]=(...t)=>e.onChange&&e.onChange(...t))},null,544),[[o.e8,e.val]])])}var xt=(0,a.aZ)({name:"t-checkbox",emits:["update:value","change"],props:{value:{type:Boolean,default:!1}},setup(e,{emit:t}){const n=(0,s.iH)(e.value);return(0,a.YP)((()=>e.value),(e=>{n.value=e})),{val:n,onChange(){const e=n.value;t("update:value",e),t("change",e)}}}});const _t=(0,y.Z)(xt,[["render",St],["__scopeId","data-v-3e7e85f6"]]);var kt=_t,Ht=(0,a.aZ)({name:"t-settings",components:{TCheckbox:kt,TProp:bt,TColor:nt,TInputNumber:$,TSize:X,TInput:D,TSelect:H,TButton:w},setup(e,{emit:t}){const n=Z(),o=(0,a.f3)(P.Provide.UpdateConfig,(()=>{})),i=(0,s.iH)(!1),{lineSpace:l,defaultFontSize:r,bgColor:c,debugBoard:u}=(0,U.Jk)(Z());(0,a.bv)((()=>{document.addEventListener("click",(()=>{i.value=!1}))}));const d=(0,a.f3)(P.Provide.UpdateBgColor,(e=>{})),g=(0,a.f3)(P.Provide.UpdateDebugBoard,(e=>{}));return{debugBoard:u,onChangeDebugBoard(){g(u.value)},bgColor:c,changeBgColor(e){Z().bgColor=e,dt.setBgColor(e),d(e)},defaultFontSize:r,lineSpace:l,isShowSettings:i,ConstVar:P,store:n,updateAlignmentHorizontal(e){n.alignmentHorizontal=e,o()},updateAlignmentVertical(e){n.alignmentVertical=e,o()},onChangeSettings(){n.changeLineSpace(l.value),o()},onChangeDefaultFontSize(e){n.defaultFontSize=e,dt.setBaseFontSize(e),o()}}}});const Tt=(0,y.Z)(Ht,[["render",ht],["__scopeId","data-v-442f8f5e"]]);var Et=Tt;async function It(e){return new Promise(((t,n)=>{const o=new FileReader;o.onload=e=>{t(e.target.result)},["image/png","image/jpeg"].find((t=>t===e.type))?o.readAsDataURL(e):n("")}))}async function Bt(){return new Promise(((e,t)=>{const n={filters:[{extensions:[".png",".jpg"]}],multi:!1},o=document.createElement("input");if(o.type="file",n.filters?.length){const e=[".png",".txt",".jpg"];let t=[];n.filters[0].extensions.forEach((n=>{n=n.startsWith(".")?n:`.${n}`;const o=e.find((e=>e===n));o&&t.push(o)})),o.accept=t.join(",")}o.multiple=!!n.multi,o.addEventListener("change",(async()=>{let t={};for(let e=0;e<o.files.length;e++){let n=o.files[e];const a=await It(n);a&&(t[n.name.toString()]=a)}e(t)})),o.dispatchEvent(new MouseEvent("click"))}))}const Dt=(0,U.Q_)("popper",{state:()=>({x:0,y:0,url:"",widthOrigin:0,heightOrigin:0,width:0,height:0})});var zt=Dt;const Mt={class:"img-handler"},Wt={class:"buttons"},Lt={key:0};function Ut(e,t,n,o,i,l){const r=(0,a.up)("TInputNumber"),s=(0,a.up)("TProp"),c=(0,a.up)("TCheckbox");return(0,a.wg)(),(0,a.iD)("div",Mt,[(0,a._)("div",Wt,[(0,a.Wm)(s,{title:"宽："},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{value:e.curWidth,"onUpdate:value":t[0]||(t[0]=t=>e.curWidth=t),min:0,onChange:e.onChangeWidth},null,8,["value","onChange"])])),_:1}),(0,a.Wm)(s,{title:"高："},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{value:e.curHeight,"onUpdate:value":t[1]||(t[1]=t=>e.curHeight=t),min:0,onChange:e.onChangeHeight},null,8,["value","onChange"])])),_:1}),(0,a.Wm)(s,{title:"锁定比例："},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{value:e.lock,"onUpdate:value":t[2]||(t[2]=t=>e.lock=t),onChange:e.onChangeLock},null,8,["value","onChange"]),e.lock?((0,a.wg)(),(0,a.iD)("span",Lt,(0,h.zw)((e.curWidth/e.widthOrigin*100).toFixed(1))+"%",1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(s,{title:"原始尺寸："},{default:(0,a.w5)((()=>[(0,a._)("div",null,(0,h.zw)(e.widthOrigin)+" * "+(0,h.zw)(e.heightOrigin),1)])),_:1})])])}var Ft=(0,a.aZ)({name:"img-handler",components:{TCheckbox:kt,TProp:bt,TButton:w,TInputNumber:$},props:{width:{type:Number,default:0},height:{type:Number,default:0}},setup(e,{emit:t}){const{width:n,height:o,widthOrigin:a,heightOrigin:i}=zt(),l=(0,s.iH)(n||e.width),r=(0,s.iH)(o||e.height),c=(0,s.iH)(!1);function u(){dt.setImageSize(l.value,r.value)}function d(){if(c.value){const e=i/a;r.value=l.value*e}u()}return{lock:c,heightOrigin:i,widthOrigin:a,curWidth:l,curHeight:r,onChangeLock(){d()},onChangeWidth:d,onChangeHeight(){if(c.value){const e=a/i;l.value=r.value*e,u()}}}}});const Pt=(0,y.Z)(Ft,[["render",Ut],["__scopeId","data-v-4cfb83f9"]]);var Rt=Pt;const Zt=e=>((0,a.dD)("data-v-9ede4008"),e=e(),(0,a.Cn)(),e),Ot=Zt((()=>(0,a._)("span",null,"超链接URL：",-1))),Nt={class:"operate"},At=Zt((()=>(0,a._)("div",{style:{flex:"1"}},null,-1)));function Vt(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",{class:"link",onMousedown:t[5]||(t[5]=(0,o.iM)((()=>{}),["stop","prevent"]))},[(0,a._)("div",{class:"url",onMousedown:t[2]||(t[2]=(0,o.iM)(((...t)=>e.onMousedown&&e.onMousedown(...t)),["stop","prevent"]))},[Ot,(0,a.wy)((0,a._)("textarea",{ref:"textarea","onUpdate:modelValue":t[0]||(t[0]=t=>e.curUrl=t),onChange:t[1]||(t[1]=(...t)=>e.onChangeUrl&&e.onChangeUrl(...t))},null,544),[[o.nr,e.curUrl]])],32),(0,a._)("div",Nt,[(0,a._)("div",{class:"btn",onClick:t[3]||(t[3]=(0,o.iM)(((...t)=>e.onBtnDel&&e.onBtnDel(...t)),["stop"]))},"删除"),At,(0,a._)("div",{class:"btn",onClick:t[4]||(t[4]=(0,o.iM)(((...t)=>e.onBtnSet&&e.onBtnSet(...t)),["stop"]))},"设置")])],32)}var $t=(0,a.aZ)({name:"t-link",setup(e,{emit:t}){const n=(0,s.iH)(zt().url),o=(0,s.iH)();return(0,a.bv)((()=>{o.value?.focus()})),(0,a.Ah)((()=>{})),{textarea:o,curUrl:n,onMousedown(){o.value?.focus()},onBtnDel(){dt.execCommand("unlink")},onBtnSet(){n.value&&(dt.execCommand("unlink"),dt.execCommand("createLink",n.value))},onChangeUrl(){}}}});const jt=(0,y.Z)($t,[["render",Vt],["__scopeId","data-v-9ede4008"]]);var qt=jt,Xt=n(16932),Jt=n(96486),Kt=n.n(Jt),Yt=n(85858);const Gt={TagFont:"font",TagSpan:"span",TagA:"a",TagImage:"img",TagHr:"hr",TagBold:"b",TagDelete:"del",TagUnderline:"u",TagItalic:"i"},Qt="font-size";class en{constructor(e){(0,ot.Z)(this,"data",void 0),(0,ot.Z)(this,"curValue",""),this.data=e}parser(e){const t=tn(e);return this.curValue=this.data[t],this}isValid(e){const t=tn(e);return!!this.data.hasOwnProperty(t)}toString(){return this.curValue||""}toBool(){return"true"===this.curValue}toInt(){return parseInt(this.curValue)||0}}function tn(e){return`@_${e}`}function nn(e){const t=tn("style");return e[t]}function on(e,t){const n=tn("style"),o=e[n];if(o){const e=o.split(";");t=e.concat(t)}e[n]=t.join(";")}function an(e){const t=ge()(e);let n=t.toHex();return n.startsWith("#")||(n=`#${n}`),n}const ln=[{ext:"png",head:"iVBORw0KGgoAAAA"},{ext:"jpeg",head:"/9j/4Q"}],rn={_fillHead(e){return`data:image/${e};base64,`},fillImageHead(e){for(let t=0;t<ln.length;t++){const{ext:n,head:o}=ln[t];if(e.startsWith(o))return this._fillHead(n)+e}return e},cutImageHead(e){const t=this.getImageExt(e);if(t){const n=this._fillHead(t);if(e.startsWith(n))return e.substring(n.length,e.length)}return e},getImageExt(e){for(let t=0;t<ln.length;t++){const{ext:n,head:o}=ln[t],a=this._fillHead(n);if(e.startsWith(a))return n}return null},async getImageSize(e){return new Promise(((t,n)=>{const o=new Image;o.src=e,o.onload=()=>{t({width:o.width,height:o.height})}}))},async compressBase64(e,t,n){return new Promise(((o,a)=>{let i=new Image;i.src=e,i.onload=()=>{let a=document.createElement("canvas");if(t>=i.width&&n>=i.height)o(e);else{a.width=t,a.height=n,a.setAttribute("width",`${t}px`),a.setAttribute("height",`${n}px`);let l=a.getContext("2d");l.clearRect(0,0,t,n),l.drawImage(i,0,0,t,n);let r=.9;const s=this.getImageExt(e);let c=a.toDataURL(`image/${s}`,r);console.log("base64:",c),o(c)}}}))}};var sn=rn;const{TagHr:cn,TagItalic:un,TagA:dn,TagSpan:gn,TagBold:pn,TagDelete:mn,TagFont:hn,TagImage:fn,TagUnderline:vn}=Gt;function Cn(e,t,n){const o=tn(t);e[o]=n}const yn={};yn[pn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];o&&Cn(e,"color",an(o))}}],yn[vn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];o&&Cn(e,"color",an(o))}}],yn[un]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];o&&Cn(e,"color",an(o))}}],yn[mn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];o&&Cn(e,"color",an(o))}}],yn[cn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["background"];if(o){const t=an(o);Cn(e,"color",t)}const a=n["height"]||"1";a&&Cn(e,"height",lt.subTail(a,"px",!0));const i=n["margin"];if(i){const t=lt.subTail(i.split(" ")[0],"px",!0);Cn(e,"margin",t)}}}],yn[dn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];o&&Cn(e,"color",an(o))}}],yn[fn]=[{key:"src",async format(e,t){const n=new en(e),o=n.parser("width").toInt(),a=n.parser("height").toInt();return o&&a&&(t=await sn.compressBase64(t,o,a)),sn.cutImageHead(t)},handle(e,t){Cn(e,"type","2")}},{key:"width",format(e,t){return lt.subTail(t,"px",!0)}},{key:"height",format(e,t){return lt.subTail(t,"px",!0)}}],yn[gn]=[{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n["color"];if(o){const t=an(o);Cn(e,"color",t)}let a=n["font-size"];a&&(a=lt.subTail(a,"px",!0),Cn(e,"size",a))}}],yn[hn]=[{key:"size",format(e,t){if("string"===typeof t)return lt.subTail(t,"px")}},{key:"draggable",del:!0},{key:"style",del:!0,handle(e,t){const n=lt.parseStyle(t),o=n[Qt];if(o){const t=lt.subTail(o,"px",!0);Cn(e,"size",t)}const a=n["color"];if(a){const t=an(a);Cn(e,"color",t)}},assembler(e,t){const n=lt.parseStyle(t),o=n["text-decoration-line"];if("line-through"===o){const t={del:Kt().clone(e)};e.length=0,e.push(t)}const a=n["font-style"];if("italic"===a){const t={i:Kt().clone(e)};e.length=0,e.push(t)}}}];const{TagHr:bn,TagItalic:wn,TagA:Sn,TagSpan:xn,TagBold:_n,TagDelete:kn,TagFont:Hn,TagImage:Tn,TagUnderline:En}=Gt,In={};var Bn;In[bn]=[{key:"color",del:!0,handle(e,t){nn(e);on(e,[`background:${t}`])}},{key:"height",del:!0,handle(e,t){on(e,[`height:${lt.fillTail(t,"px")}`])}},{key:"margin",del:!0,handle(e,t){on(e,[`margin:${lt.fillTail(t,"px")} 0;`])}}],In[En]=[{key:"color",handle(e,t){on(e,[`color:${t}`])}}],In[wn]=[{key:"color",handle(e,t){on(e,[`color:${t}`])}}],In[kn]=[{key:"color",handle(e,t){on(e,[`color:${t}`])}}],In[_n]=[{key:"color",handle(e,t){on(e,[`color:${t}`])}}],In[Sn]=[{key:"color",handle(e,t){on(e,[`color:${t}`])}}],In[xn]=[{key:""}],In[Hn]=[{key:"size",del:!0,handle(e,t){const n=nn(e);if(n){const o=n.split(";");let a=[];o.forEach((e=>{let[n,o]=e.split(":");n===Qt&&(o=lt.fillTail(t,"px")),a.push(`${n}:${o}`)})),on(e,a)}else{const n=lt.fillTail(t,"px");on(e,[`${Qt}:${n}`])}}}],In[Tn]=[{key:"type",del:!0},{key:"src",format(e){return sn.fillImageHead(e)}}],function(e){e[e["BothSidesSwap"]=0]="BothSidesSwap",e[e["Editor2Engine"]=1]="Editor2Engine",e[e["Engine2Editor"]=2]="Engine2Editor"}(Bn||(Bn={}));const Dn=[{editor:"strike",engine:"del",type:Bn.BothSidesSwap},{editor:"span",engine:"font",type:Bn.Editor2Engine}],zn=!0,Mn=!1,Wn=!1,Ln=!0,Un=!0,Fn=":@",Pn={preserveOrder:zn,ignoreAttributes:Mn,unpairedTags:["br","hr"],trimValues:Wn,parseTagValue:!1,allowBooleanAttributes:!0,stopNodes:["*.hr","*.br"]},Rn={preserveOrder:zn,ignoreAttributes:Mn,format:!1,suppressUnpairedNode:Un,suppressEmptyNode:!0,suppressBooleanAttributes:!0};class Zn{constructor(){(0,ot.Z)(this,"transformKey",{}),(0,ot.Z)(this,"attributeCfg",{}),(0,ot.Z)(this,"_valueCheck",(e=>e))}_init(e){this._confirmTransformKey(e),this._initValueCheckFunction(e)}_initValueCheckFunction(e){e||(this._valueCheck=e=>e)}_confirmTransformKey(e){e?(this.attributeCfg=yn,Dn.forEach((e=>{e.type!==Bn.BothSidesSwap&&e.type!==Bn.Editor2Engine||(this.transformKey[e.editor]=e.engine)}))):(this.attributeCfg=In,Dn.forEach((e=>{e.type!==Bn.BothSidesSwap&&e.type!==Bn.Engine2Editor||(this.transformKey[e.engine]=e.editor)})))}async checkProperty(e,t){const n=this.attributeCfg[e];if(n)for(let o=0;o<n.length;o++){const a=n[o],i=t[Fn],l=tn(a.key);a.assembler&&i&&i[l]&&a.assembler(t[e],i[l]),a.handle&&i&&i[l]&&a.handle(i,i[l]),a.format&&i&&i[l]&&(i[l]=await a.format(i,i[l])),!0===a.del&&i&&delete i[l]}}async cloneVar(e,t){if(Kt().isArray(t)&&Kt().isArray(e))for(let n=0;n<t.length;n++){let o=t[n];if(Kt().isArray(o)){let t=[];await this.cloneVar(t,o),e.push(t)}else if(Kt().isObject(o)){const t=Object.keys(o);for(let e=0;e<t.length;e++){const n=t[e];await this.checkProperty(n,o)}let n={};await this.cloneVar(n,o),e.push(n)}else e.push(o)}else if(Kt().isObject(t)&&Kt().isObject(e))for(let n in t){let o=t[n];if("string"===typeof o||"number"===typeof o||"boolean"===typeof o)e[n]=this._valueCheck(o);else if(Array.isArray(o)){let o=n;this.transformKey[n]&&(o=this.transformKey[n]),e[o]=[],await this.cloneVar(e[o],t[n])}else Kt().isObject(o)&&(e[n]={},await this.cloneVar(e[n],o))}}getSettingsXML(e){const t=Z();let n={};e||(n[tn("fixSize")]=t.fixSize.toString(),n[tn("fixWidth")]=t.fixWidth.toString(),n[tn("fixHeight")]=t.fixHeight.toString(),n[tn("alignmentHorizontal")]=t.alignmentHorizontal.toString(),n[tn("alignmentVertical")]=t.alignmentVertical.toString()),n[tn("lineSpace")]=t.lineSpace.toString();const o=[{settings:[{"#text":""}],":@":n}],a={processEntities:!1,format:!1,ignoreAttributes:!1,preserveOrder:!0,suppressBooleanAttributes:!0},i=new Xt.XMLBuilder(a);return i.build(o)}async editor2engine(e,t){this._init(!0);const n=new Xt.XMLParser(Pn);e=e.replace(/&nbsp;/g," "),e=e.replace(/<br>/g,"<br/>");const o=this.getSettingsXML(t);e=`${o}${e}`;let a=n.parse(e),i=[];await this.cloneVar(i,a);let l=new Xt.XMLBuilder(Rn),r=l.build(i);return Ln&&console.log(Yt.ZP.red("Editor -> Engine: \n",r)),r}_peelOffSettings(e){const t=Z();for(let n=0;n<e.length;){const o=e[n];if(o[Fn]){const a=new en(o[Fn]);if(o["settings"]){t.lineSpace=a.parser("lineSpace").toInt(),t.alignmentHorizontal=a.parser("alignmentHorizontal").toInt(),t.alignmentVertical=a.parser("alignmentVertical").toInt(),e.splice(n,1);continue}o[Gt.TagFont]&&(t.defaultFontSize=a.parser("size").toInt())}n++}}_peelOffRootFont(e){for(let t=0;t<e.length;){const n=e[t];if(n[Fn]){const e=new en(n[Fn]);if(n["font"]){if(e.isValid("size")){const t=e.parser("size").toInt();console.log(`editor->engine: font-size=${t}`),dt.setBaseFontSize(t)}return n["font"]}}t++}return e}async engine2editor(e){this._init(!1);const t=new Xt.XMLParser(Pn);let n=t.parse(e);this._peelOffSettings(n),n=this._peelOffRootFont(n);let o=[];await this.cloneVar(o,n);let a=new Xt.XMLBuilder(Rn);const i=a.build(o);return Ln&&console.log(Yt.ZP.green("Engine -> Editor: ",i)),i}}const On=e=>((0,a.dD)("data-v-75183c33"),e=e(),(0,a.Cn)(),e),Nn={class:"import"},An=On((()=>(0,a._)("div",{class:"title"},"请输入导入的xml：",-1))),Vn={class:"bottom"};function $n(e,t,n,i,l,r){return(0,a.wg)(),(0,a.iD)("div",Nn,[An,(0,a.wy)((0,a._)("textarea",{ref:"textarea","onUpdate:modelValue":t[0]||(t[0]=t=>e.xml=t)},null,512),[[o.nr,e.xml]]),(0,a._)("div",Vn,[(0,a._)("button",{onClick:t[1]||(t[1]=(...t)=>e.onImport&&e.onImport(...t))},"导入")])])}const jn="ShowDialog",qn={Close:"dialog-close"};class Xn{constructor(){(0,ot.Z)(this,"emitter",new rt.TinyEmitter)}show(e){this.emitter.emit(jn,e)}on(e){this.emitter.on(jn,e)}}const Jn=new Xn;var Kn=Jn,Yn=(0,a.aZ)({name:"t-import",components:{TButton:w},props:{data:{type:Object}},setup(e,{emit:t}){const n=(0,s.iH)(""),o=(0,a.f3)(qn.Close,(()=>{})),i=(0,s.iH)();return(0,a.bv)((()=>{i.value?.focus()})),{textarea:i,xml:n,onImport(){o();const t=(0,s.IU)(n.value);t&&e.data?.callback(t)}}}});const Gn=(0,y.Z)(Yn,[["render",$n],["__scopeId","data-v-75183c33"]]);var Qn=Gn;const eo=e=>((0,a.dD)("data-v-e716939e"),e=e(),(0,a.Cn)(),e),to={class:"export"},no=["value"],oo={class:"bottom"},ao=eo((()=>(0,a._)("div",{style:{flex:"1"}},null,-1)));function io(e,t,n,o,i,l){return(0,a.wg)(),(0,a.iD)("div",to,[(0,a._)("textarea",{value:e.xml,readonly:""},null,8,no),(0,a._)("div",oo,[(0,a._)("button",{onClick:t[0]||(t[0]=(...t)=>e.onClickGetHtml&&e.onClickGetHtml(...t))},"HTML"),ao,(0,a._)("button",{class:"close",onClick:t[1]||(t[1]=(...t)=>e.onClickClose&&e.onClickClose(...t))},"关闭"),(0,a._)("button",{class:"copy",onClick:t[2]||(t[2]=(...t)=>e.onClickCopy&&e.onClickCopy(...t))},"复制")])])}var lo=n(42152),ro=n.n(lo),so=(0,a.aZ)({name:"t-export",setup(e,{emit:t}){(0,a.bv)((async()=>{const e=dt.getInnerHtml(!0);n.value=await(new Zn).editor2engine(e,!0)}));const n=(0,s.iH)(""),o=(0,a.f3)(qn.Close,(()=>{}));return{xml:n,onClickCopy(){ro().copy(n.value)},onClickClose(){o()},onClickGetHtml(){const e=dt.getInnerHtml();ro().copy(e)}}}});const co=(0,y.Z)(so,[["render",io],["__scopeId","data-v-e716939e"]]);var uo=co;const go={class:"hr-handler"},po={style:{display:"flex","flex-direction":"row","justify-content":"flex-end"}};function mo(e,t,i,l,r,s){const c=(0,a.up)("TButton"),u=(0,a.up)("TColor"),d=(0,a.up)("TProp"),g=(0,a.up)("TInputNumber");return(0,a.wg)(),(0,a.iD)("div",go,[(0,a.Wm)(c,{svg:n(30758),onClick:e.onDividingLine,title:"在当前位置插入分割线"},null,8,["svg","onClick"]),e.showHrHandler?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"panel",onMousedown:t[4]||(t[4]=(0,o.iM)((()=>{}),["stop"]))},[(0,a.Wm)(d,{title:"颜色："},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{style:{},color:e.color,"onUpdate:color":t[0]||(t[0]=t=>e.color=t)},null,8,["color"])])),_:1}),(0,a.Wm)(d,{title:"线宽："},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{width:"120px"},value:e.lineWidth,"onUpdate:value":t[1]||(t[1]=t=>e.lineWidth=t),min:1},null,8,["value"])])),_:1}),(0,a.Wm)(d,{title:"边宽："},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{style:{width:"120px"},value:e.margin,"onUpdate:value":t[2]||(t[2]=t=>e.margin=t),min:1},null,8,["value"])])),_:1}),(0,a._)("div",po,[(0,a._)("button",{onClick:t[3]||(t[3]=(0,o.iM)(((...t)=>e.onInsert&&e.onInsert(...t)),["stop","prevent"]))},"插入")])],32)):(0,a.kq)("",!0)])}var ho=(0,a.aZ)({name:"hr-handler",components:{TButton:w,TColor:nt,TProp:bt,TInputNumber:$},props:{},setup(){const e=(0,s.iH)(1),t=(0,s.iH)("#ffffff"),n=(0,s.iH)(!1);(0,a.bv)((()=>{document.addEventListener("mousedown",(()=>{n.value=!1}))}));const o=(0,s.iH)(2);return{showHrHandler:n,lineWidth:e,color:t,margin:o,onDividingLine(){n.value=!n.value},onInsert(){n.value=!1,dt.insertHR(t.value,e.value,o.value),dt.selectEnd(),dt.focus()}}}});const fo=(0,y.Z)(ho,[["render",mo],["__scopeId","data-v-eaf896f4"]]);var vo=fo,Co=(0,a.aZ)({name:"tool-bar",components:{HrHandler:vo,TExport:uo,TImport:Qn,TSettings:Et,TColor:nt,TInputNumber:$,TSize:X,TInput:D,TSelect:H,TButton:w},setup(e,{emit:t}){const n=(0,s.iH)([{label:"宋体",value:"song"},{label:"楷体",value:"kai"}]);let o=[];for(let a=2;a<=300;a+=2)o.push({label:a.toString(),value:a.toString()});const i=(0,s.iH)(o),l=(0,s.iH)("kai"),r=(0,s.iH)(10),c=(0,s.iH)("20"),u=Z(),d=(0,s.iH)(u.alignmentVertical),g=(0,s.iH)(u.alignmentHorizontal),p=(0,a.f3)(P.Provide.UpdateConfig,(e=>{}));function m(){console.log("onTest")}const h=(0,s.iH)(!1),f=(0,s.iH)(!1),v=(0,s.iH)(!1),C=(0,s.iH)(!1);dt.emitter.on(P.Msg.UpdateCommandState,(()=>{if(dt.isSelectImgTag()||dt.isSelectEmpty)return C.value=!0,v.value=!0,f.value=!0,void(h.value=!0);C.value=!1,v.value=!1,f.value=!1,h.value=!1,dt.isApplyCommandEffect(P.Command.Delete)&&(v.value=!0),dt.isApplyCommandEffect(P.Command.Underline)&&(C.value=!0)}));const y=(0,a.f3)(P.Provide.SetRefBg,(e=>{}));return{onTest:m,ConstVar:P,store:u,disabledBold:h,disabledItalic:f,disabledUnderline:v,disabledDelete:C,alignmentVertical:d,alignmentHorizontal:g,fonts:n,fontSizeCfg:i,curFontFamily:l,curFontSize:r,curFontSizeStr:c,onChangColor(e,t){dt.execCommand("foreColor",e),p("")},onImport(){const e={async callback(e){console.log(e);const t=await(new Zn).engine2editor(e);dt.setInnerHtml(t)}};Kn.show({comp:(0,s.Xl)(Qn),data:e})},onExport(){Kn.show({comp:(0,s.Xl)(uo),maskClose:!0})},onShowLink(){dt.isSelectEmpty||(zt().url=dt.getSelectContentLink()||"",dt.emitter.emit(P.Msg.ShowPopper,{comp:(0,s.Xl)(qt)}))},onUndo(){dt.execCommand("undo")},onRedo(){dt.execCommand("redo")},onBold(){dt.execCommand("bold")},onItalic(){dt.execCommand("italic")},onUnderline(){dt.isApplyCommandEffect(P.Command.Delete)?console.warn("无法设置下划线效果：和删除线互斥"):(dt.execCommand(P.Command.Underline),dt.emitter.emit(P.Msg.UpdateCommandState))},onStrikeThrough(){dt.isApplyCommandEffect(P.Command.Underline)?console.warn("无法设置删除线效果：和下划线互斥"):(dt.execCommand(P.Command.Delete),dt.emitter.emit(P.Msg.UpdateCommandState))},onRemoveFormat(){dt.execCommand("removeFormat")},onCreateLink(){dt.execCommand("insertImage")},onFontChange(){console.log(l.value),dt.execCommand("fontName","Arial")},onChangeFontSize(){dt.execCommand("fontSize",(r.value||0).toString())},onChangeFontSizeStr(){dt.setSelectFontSize(parseInt(c.value))},async onSetRefBg(){const e=await Bt(),t=Object.keys(e);if(t.length){const n=e[t[0]];n&&y(n)}},async onInsertImg(){if(dt.isSelectImgTag()){const e=dt.getSelectTag().el,t=e.src,{width:n,height:o}=await sn.getImageSize(t);let a=e.getAttribute("width")||n.toString(),i=e.getAttribute("height")||o.toString();a&&(a=lt.subTail(a,"px",!0)),i&&(i=lt.subTail(i,"px",!0)),zt().widthOrigin=n,zt().heightOrigin=o,zt().width=parseInt(a),zt().height=parseInt(i),dt.emitter.emit(P.Msg.ShowPopper,{comp:(0,s.Xl)(Rt)})}else{const e=await Bt(),t=Object.keys(e);if(t.length){const n=e[t[0]];dt.execCommand("insertImage",n)}}}}}});const yo=(0,y.Z)(Co,[["render",m],["__scopeId","data-v-48a90e95"]]);var bo=yo,wo=n(7597),So=n.n(wo);class xo{constructor(e){(0,ot.Z)(this,"id",""),(0,ot.Z)(this,"isReady",!1),(0,ot.Z)(this,"rpcList",{}),(0,ot.Z)(this,"url","ws://localhost:2022"),(0,ot.Z)(this,"ws",null),(0,ot.Z)(this,"messages",[]),this.id=e}onMessage(e){console.log(Yt.ZP.yellow("message",e.data));let t=JSON.parse(e.data),{action:n,data:o,rpc:a,from:i,to:l}=t;const r=this.rpcList[a];if(r)try{const e=JSON.parse(o);r(e),delete this.rpcList[a]}catch(s){console.error(s)}else console.warn("invalid action",n)}_sendMessage(e){this.ws?this.ws.send(JSON.stringify(e)):console.warn("Not connected to server, can not send data")}dispatch(e){const t=So().generate(),n={from:this.id,to:e.panel,rpc:t,type:"dispatch",action:e.action,data:JSON.stringify(e.data||{})};this.rpcList[t]=e.response||(e=>{}),this._sendMessage(n)}register(){this._sendMessage({type:"register",to:this.id})}async init(){return new Promise(((e,t)=>{let n=new WebSocket(this.url);n.onopen=()=>{console.log("open"),this.isReady=!0,this.register(),e(0)},n.onmessage=this.onMessage.bind(this),n.onerror=()=>{this.isReady=!1,this.ws=null,console.log("error"),e(2)},n.onclose=()=>{this.isReady=!1,this.ws=null,console.log("onclose"),e(1)},this.ws=n}))}}var _o={RichText:{Name:"rich-text",MsgUpdateRichText:"update-rich-text"},Main:{Name:"main",MsgGetRichText:"get-rich-text",MsgUpdateRichText:"update-rich-text",MsgSetBgColor:"set-bg-color",MsgSetBg:"set-ref-bg",MsgUpdateDebugBoard:"update-debug-board"}};function ko(e,t,n,i,l,r){return(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["popper",{"popper-row-reverse":!e.normalOrder}]),style:(0,h.j5)(e.style),ref:"compElement"},[(0,a._)("div",{class:(0,h.C_)(["triangle",{"triangle-down":!e.normalOrder}])},null,2),((0,a.wg)(),(0,a.j4)((0,a.LL)(e.comp)))],6)),[[o.F8,e.visible]])}var Ho=(0,a.aZ)({name:"t-popper",components:{TImport:Qn,TInputNumber:$},props:{},setup(e,{emit:t}){const n=(0,a.Fl)((()=>{const e=zt().x,t=zt().y;return`left:${e}px;top:${t}px`})),o=(0,s.iH)(!0);function i(){let{x:e,y:t,type:n}=dt.getPopperPositionBySelect();if(n===it.Bottom)o.value=!0;else if(n===it.Top){o.value=!1;let e=p.value?.clientHeight||0;t-=e}zt().x=e,zt().y=t}let l=0;function r(){i(),l=setInterval((()=>{i()}),300)}function c(){l&&clearInterval(l)}(0,a.bv)((()=>{})),(0,a.Ah)((()=>{c()}));const u=(0,s.iH)(!1),d=(0,s.iH)();function g(){const e=dt.getDocument();if(e){const t=()=>{u.value=!1,c(),e.removeEventListener("mousedown",t)};e.removeEventListener("mousedown",t),e.addEventListener("mousedown",t)}}dt.emitter.on(P.Msg.ShowPopper,(e=>{d.value=e.comp,u.value=!0,(0,a.Y3)((()=>{r()})),g()}));const p=(0,s.iH)();return{style:n,comp:d,visible:u,normalOrder:o,compElement:p}}});const To=(0,y.Z)(Ho,[["render",ko],["__scopeId","data-v-62b010ad"]]);var Eo=To,Io='<html style="width: 100%;height: 100%;margin: 0;padding: 0;">\r\n<head>\r\n  <title></title>\r\n  <style type="text/css">\r\n      html {\r\n          margin: 0;\r\n          padding: 0;\r\n          width: 100%;\r\n          height: 100%;\r\n          overflow: hidden;\r\n      }\r\n\r\n      a {\r\n          text-decoration: none;\r\n          color: inherit;\r\n      }\r\n\r\n      * {\r\n          -webkit-user-drag: none;\r\n      }\r\n\r\n      hr {\r\n          margin: 2px 0;\r\n          border: 0;\r\n      }\r\n\r\n      body {\r\n          width: 100%;\r\n          height: 100%;\r\n          margin: 0;\r\n          white-space: pre-wrap;\r\n          padding: 0;\r\n          color: white;\r\n          background-color: black;\r\n          box-sizing: border-box;\r\n          outline: none;\r\n          border: black 1px solid;\r\n          flex: 1;\r\n          font-size: 20px;\r\n          overflow-x: auto;\r\n          overflow-y: auto;\r\n      }\r\n  </style>\r\n</head>\r\n<body contenteditable=\'true\'>rich text</body></html>';const Bo={key:0,class:"dialog"};function Do(e,t,n,i,l,r){return e.visible?((0,a.wg)(),(0,a.iD)("div",Bo,[(0,a._)("div",{class:"mask",onClick:t[1]||(t[1]=(0,o.iM)(((...t)=>e.onClickMask&&e.onClickMask(...t)),["stop"]))},[(0,a._)("div",{onClick:t[0]||(t[0]=(0,o.iM)((()=>{}),["stop"])),class:"content"},[((0,a.wg)(),(0,a.j4)((0,a.LL)(e.comp),{data:e.curData},null,8,["data"]))])])])):(0,a.kq)("",!0)}var zo=(0,a.aZ)({name:"t-dialog",props:{option:{type:Object,default:()=>({})}},setup(e,{emit:t}){const n=(0,s.iH)(e.option?.comp),o=(0,s.iH)(!1),i=(0,s.iH)(e.option?.data);let l=(0,s.IU)(e.option?.maskClose);function r(){o.value=!1,document.removeEventListener("keydown",c)}function c(e){27===e.keyCode&&r()}return Kn.on((e=>{o.value=!0,l=e.maskClose,n.value=e.comp,i.value=e.data,document.addEventListener("keydown",c)})),(0,a.JJ)(qn.Close,(()=>{r()})),{visible:o,curData:i,comp:n,onClickMask(){!1!==l&&(n.value=null,o.value=!1)}}}});const Mo=(0,y.Z)(zo,[["render",Do],["__scopeId","data-v-0834ae0b"]]);var Wo=Mo,Lo=(0,a.aZ)({name:"xml-text-editor",components:{TDialog:Wo,ImgHandler:Rt,TPopper:Eo,TLink:qt,ToolBar:bo},setup(e,{emit:t}){const n=Z();let o;const i=(0,s.iH)(Io||""),l=(0,s.iH)();async function r(e){let t=await(new Zn).editor2engine(e,!1);o.dispatch({panel:_o.Main.Name,action:_o.Main.MsgUpdateRichText,data:{xml:t}})}let c="",u="";const d=(0,s.iH)();(0,a.bv)((async()=>{lt.seepFrameEvent(),await dt.initWithFrame(l.value,{}),setInterval((async()=>{u=dt.getInnerHtml(),u.length===c.length&&c===u||(c=u,await r(u))}),500),o=new xo(_o.RichText.Name);let e=await o.init();0!==e&&console.error("panel init failed"),o.messages[_o.RichText.MsgUpdateRichText]=async e=>{let{r:t,g:n,b:o}=e.bg;t*=255,n*=255,o*=255;const a=an({r:t,g:n,b:o});Z().bgColor=a,dt.setBgColor(a);const i=await(new Zn).engine2editor(e.xml);dt.setInnerHtml(i);const{debugBoard:l}=e;Z().debugBoard=l},o.dispatch({panel:_o.Main.Name,action:_o.Main.MsgGetRichText})}));const g=(0,s.iH)(n.xml);return(0,a.JJ)(P.Provide.UpdateConfig,(e=>{r(u)})),(0,a.JJ)(P.Provide.UpdateBgColor,(e=>{const{r:t,g:n,b:a,a:i}=ge()(e).toRgb();o.dispatch({panel:_o.Main.Name,action:_o.Main.MsgSetBgColor,data:{r:t,g:n,b:a,a:i}})})),(0,a.JJ)(P.Provide.SetRefBg,(async e=>{const{width:t,height:n}=await sn.getImageSize(e);e=await sn.compressBase64(e,t,n),e=sn.cutImageHead(e),o.dispatch({panel:_o.Main.Name,action:_o.Main.MsgSetBg,data:{data:e,width:t,height:n}})})),(0,a.JJ)(P.Provide.UpdateDebugBoard,(e=>{o.dispatch({panel:_o.Main.Name,action:_o.Main.MsgUpdateDebugBoard,data:{show:e}})})),{frame:l,frameSource:i,xml:g,editor:d}}});const Uo=(0,y.Z)(Lo,[["render",r],["__scopeId","data-v-3949e137"]]);var Fo=Uo;(0,o.ri)(Fo).use((0,U.WB)()).mount("#app")},65932:function(e,t,n){e.exports=n.p+"img/background.3e1bd040.svg"},27654:function(e,t,n){e.exports=n.p+"img/bold.f405a602.svg"},30758:function(e,t,n){e.exports=n.p+"img/dividingLine.9e4ca0a6.svg"},88420:function(e,t,n){e.exports=n.p+"img/export.8a12c566.svg"},9396:function(e,t,n){e.exports=n.p+"img/image.4e48e882.svg"},44319:function(e,t,n){e.exports=n.p+"img/import.d69ab00a.svg"},38548:function(e,t,n){e.exports=n.p+"img/italic.6c12d4dd.svg"},78066:function(e,t,n){e.exports=n.p+"img/justifyCenter.763dec34.svg"},32851:function(e,t,n){e.exports=n.p+"img/justifyLeft.16ff8c27.svg"},42482:function(e,t,n){e.exports=n.p+"img/justifyRight.d8e7ee39.svg"},58991:function(e,t,n){e.exports=n.p+"img/link.95d274a6.svg"},24990:function(e,t,n){e.exports=n.p+"img/lock.31dcb985.svg"},65251:function(e,t,n){e.exports=n.p+"img/removeFormat.abcae32f.svg"},70134:function(e,t,n){e.exports=n.p+"img/settings.9aaade1f.svg"},24580:function(e,t,n){e.exports=n.p+"img/strikeThrough.afa81513.svg"},22241:function(e,t,n){e.exports=n.p+"img/underline.28ade895.svg"},65446:function(e,t,n){e.exports=n.p+"img/unlock.0798ba85.svg"},55187:function(e,t,n){e.exports=n.p+"img/vertical-bottom.1ec60420.svg"},55359:function(e,t,n){e.exports=n.p+"img/vertical-center.02fa8c76.svg"},57937:function(e,t,n){e.exports=n.p+"img/vertical-top.709104c7.svg"}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,o,a,i){if(!o){var l=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],i=e[u][2];for(var r=!0,s=0;s<o.length;s++)(!1&i||l>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(r=!1,i<l&&(l=i));if(r){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[o,a,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.e=function(){return Promise.resolve()}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.j=3091}(),function(){n.p="/"}(),function(){var e={3091:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,i,l=o[0],r=o[1],s=o[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(s)var u=s(n)}for(t&&t(o);c<l.length;c++)i=l[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(u)},o=self["webpackChunkrich_text_editor"]=self["webpackChunkrich_text_editor"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[4998],(function(){return n(73032)}));o=n.O(o)})();